package fracCalc;

import java.util.Scanner;

public class FracCalc {
	

    public static void main(String[] args) 
    {
        // TODO: Read the input from the user and call produceAnswer with an equation
   
    	System.out.println("Enter your operands, only two operands and a operator to compile.");
    	Scanner userInput = new Scanner(System.in);
    	String inputNum = userInput.nextLine();
    	while(inputNum != "quit"){
    		int[] answers = produceAnswer(inputNum);
    		System.out.print("whole:" + answers[0]);
    		System.out.print(" numerator:" + answers[1]);
    		System.out.print(" denominator:" + answers[2]);
    		System.out.println(answers[3] + "_" + answers[4] + "/" + answers[5]);
    		
    		
    		System.out.println(" ");
    		inputNum = userInput.nextLine();
    	}
    		
    	

    }
    
    // ** IMPORTANT ** DO NOT DELETE THIS FUNCTION.  This function will be used to test your code
    // This function takes a String 'input' and produces the result
    //
    // input is a fraction string that needs to be evaluated.  For your program, this will be the user input.
    //      e.g. input ==> "1/2 + 3/4"
    //        
    // The function should return the result of the fraction after it has been calculated
    //      e.g. return ==> "1_1/4"
    
    public static int[] produceAnswer(String input){
    	int[] storedValues = {0,0,0,0,0,0};
    	String[] inputParse = parseInput(input); // Splits the expression from space; gets 1st Operand, 2nd Operand, & operator
    	
    	//Takes the output of parseInput, and splits to find the whole, numerator, and denominator
    	int[] firstOperand = parseOperand(inputParse[0]); // The first operand of the expression
    	int[] secondOperand = parseOperand(inputParse[2]);// The second operand of the expression
    	int[] operator = parseOperand(inputParse[1]);     // The operator of the expression
    	String operatorSign = Integer.toString(operator[0]);
    	
    	int[] improperFirst = toImproperFrac(firstOperand[0], firstOperand[1], firstOperand[2]);
    	int[] improperSecond = toImproperFrac(secondOperand[0], secondOperand[1], secondOperand[2]);
    	
    	for(int i = 0; i < 3; i++){
    		storedValues[i] = secondOperand[i];
    	}
    	
    	if(operatorSign == "+" || operatorSign == "-"){
    		int[] addOrSubtract = addSubtractFrac(firstOperand, secondOperand, operator);
    		for(int i = 3; i < 6; i++){
        		storedValues[i] = secondOperand[i-3];
        	}
    		
    	}
    	
    	
    	
    	
    	return storedValues;
    	
    	
    }
    public static String[] parseInput(String inputExpression){
       String[] inputArray = inputExpression.split("\\s+"); //must split from the space since it will not always be a "+" operator
       return inputArray;							        
       
    }
    
   public static int[] parseOperand(String num){
	  int[] individualNum = {0, 0, 0};// collects the integers for whole,numerator, and denominator
	  					  // index 0 = whole; index 1 = numerator; index 2 = denominator
	  
	//checks if the expression has a "_"
	  if(num.indexOf("_" ) > 0){  
		  
	      String[] wholeNumSplit = num.split("_"); //splits to get get the whole number
	      individualNum[0] = Integer.parseInt(wholeNumSplit[0]); //changes the string into the return type, integer
	        
	      String[] numeratorSplit = wholeNumSplit[1].split("/"); // splits to get the numerator and denominator
	      individualNum[1] = Integer.parseInt(numeratorSplit[0]);// the numerator
	      individualNum[2] = Integer.parseInt(numeratorSplit[1]);// the denominator 
	       
	      return individualNum;
	 
	  //checks if the expression has a "/"
      }else if(num.indexOf("/") > 0){ 
    	  String[] numeratorSplit = num.split("/"); // splits to get the numerator and denominator
    	  individualNum[1] = Integer.parseInt(numeratorSplit[0]);// the numerator
	      individualNum[2] = Integer.parseInt(numeratorSplit[1]);// the denominator 
	      
	      return individualNum;
	      
	  //If the expression does not have a "_" or "/" then it is a whole number   
      }else{ 
    	  individualNum[0] = Integer.parseInt(num); 
    	  return individualNum;
      }
   }
   
   public static int[] toImproperFrac(int a, int b, int c){
	   int[] num = {0, 0};
	   	int x = c * a;
		int y = x + b;
		num[0] = y;
		num[1] = c;
		
		return num;
   }
   
   public static int[] addSubtractFrac(int[] impropOne, int[] impropTwo, int[] operators){
	   int[] sum = {0,0,0}; //new whole = index 0; new Numerator = index 1; new Denominator = 2
	   int crossMultipleOne = impropOne[0] * impropTwo[1]; 
	   int crossMultipleTwo = impropOne[1] * impropTwo[0];
	   int commonDenominator = impropOne[1] * impropTwo[1];
	   String operatorSign = Integer.toString(operators[0]);
	   
	   if(operatorSign == "+"){
		   int addCrossMultiple = crossMultipleOne + crossMultipleTwo;
		   int calcWhole = addCrossMultiple / commonDenominator;
		   int calcNumerator = addCrossMultiple % commonDenominator;
		   
		   sum[0] = calcWhole;
		   sum[1] = calcNumerator;
		   sum[2] = commonDenominator;
		   
		   return sum;
	   }
	   return sum;
	   
	   
   }
}
